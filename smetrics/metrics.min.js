var smetrics={uslog:!1,readTextFile:function(e,t){var s=new XMLHttpRequest;s.overrideMimeType("application/json"),s.open("GET",e,!0),s.onreadystatechange=function(){4===s.readyState&&("200"==s.status?t(s.responseText):t("~993"))},s.send(null)},showlog:function(e,t,s){s&&(t&&console.log(t),console.log(e))},sendRequest:function(e,t){var s="metrics-data="+JSON.stringify(e);s=s.replace(/&/g,"%26");var n=new XMLHttpRequest;n.open("POST","/smetrics/metrics.php"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(s),n.onreadystatechange=function(){if(4===n.readyState)if("200"==n.status){smetrics.showlog(n.responseText,"xmlhttp.responseText:",smetrics.uslog);try{var e=JSON.parse(n.responseText)}catch(e){return void t(n.responseText)}"done"==e.status?t(e.data):"failed"==e.status?t("~995"):t("~996")}else t("~997")}},getSelectors:function(e){var t=window.location.pathname.replace(/(.*)(index.php|index.html).*$/,"$1");t=(t=t.replace(/(.*)(\?|#).*$/,"$1")).replace(/[\/]{2,}/g,"/");var s=[];for(var i in e){var o=!1;if(t==i||"*"==i?o=!0:-1!=(n=i.indexOf("*"))&&(item_n=i.substr(0,n-1),cur_url_n=t.substr(0,n-1),item_n==cur_url_n&&(o=!0)),o)for(var a in e[i])s.push({selector:e[i][a].selector,smcache:a,isJs:e[i][a].isJs})}return s},dataCollection:function(t,s){function e(e){return("00"+e).slice(-2)}if("FORM"!=t.tagName){if("FORM"!=t.target.tagName)return console.log("~889"),!1;t=t.target}this.showlog(t,"etarget:",smetrics.uslog);var n={},i=[],o=[],a={},r=window.screen.width*window.devicePixelRatio,c=window.screen.height*window.devicePixelRatio,l=window.screen.availWidth*window.devicePixelRatio,u=window.screen.availHeight*window.devicePixelRatio,d=window.location.host,m=window.location.pathname,p=window.location.protocol,h=window.location.href,g=new Date,w=g.getFullYear()+"-"+e(g.getMonth()+1)+"-"+e(g.getDate())+" "+e(g.getHours())+":"+e(g.getMinutes())+":"+e(g.getSeconds()),f=-g.getTimezoneOffset()/60;n.info={scrin_width:r,scrin_height:c,avail_width:l,avail_height:u,host:d,cur_url:m,protocol:p,href:h,datetimeClient:w,timeZoneClient:f,cache:t.smcache};for(var v=0;a={},null!=(input=t[v]);v++)if("submit"!=input.type)if(a.type=input.type,a.name=input.name,"hidden"==input.type||"none"===input.style.display)a.value=input.value,o.push(a);else if("select-one"==input.type||"select-multiple"==input.type){a.selects=[];for(var y=0;null!=input.selectedOptions[y];y++)mselect={innerHTML:input.selectedOptions[y].innerHTML,value:input.selectedOptions[y].value},a.selects.push(mselect);i.push(a)}else"text"==input.type||input.type,a.value=input.value,i.push(a);n.inputs=i,n.inputs_hidden=o,this.showlog(n,"send metrics:",smetrics.uslog),this.sendRequest(n,function(e){(t.smAnswer=e).length<250?smetrics.showlog(e,"answer:",smetrics.uslog):smetrics.showlog("","answer: ready shown above...",smetrics.uslog),s&&s(t)})}};smetrics.readTextFile("/smetrics/config.json",function(e){!function(e,t){"use strict";e=e||"docReady",t=t||window;var s=[],n=!1,i=!1;function o(){if(!n){n=!0;for(var e=0;e<s.length;e++)s[e].fn.call(window,s[e].ctx);s=[]}}function a(){"complete"===document.readyState&&o()}t[e]=function(e,t){if("function"!=typeof e)throw new TypeError("callback for docReady(fn) must be a function");n?setTimeout(function(){e(t)},1):(s.push({fn:e,ctx:t}),"complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(o,1):i||(document.addEventListener?(document.addEventListener("DOMContentLoaded",o,!1),window.addEventListener("load",o,!1)):(document.attachEvent("onreadystatechange",a),window.attachEvent("onload",o)),i=!0))}}("metricsReady",window);var l="";try{var t=JSON.parse(e);l=smetrics.getSelectors(t)}catch(e){console.log("~994")}metricsReady(function(){for(var e,t,s,n,i=/\s(\d+)metricsReady/,o=0;o<l.length;o++)if(n=(s=l[o].selector.split(i))[0],smetrics.showlog(n,"selector:",smetrics.uslog),null!=(e=document.querySelectorAll(n))[t=null==s[1]?0:s[1]-1]){var a=l[o].smcache,r=l[o].isJs;smetrics.showlog(a,"smcache:",smetrics.uslog),e[t].smcache=a;var c="default";switch((e[t].smIsJs=r)?c="isJs":(metrics_id=e[t].getAttribute("id"))&&0==metrics_id.indexOf("formAcymailing")&&(c="isAcymailing"),c){case"default":e[t].addEventListener("submit",function(e){e.preventDefault(),smetrics.dataCollection(e,function(e){e&&e.submit()})});break;case"isJs":smetrics.showlog(e[t],"this isJs:",smetrics.uslog);break;case"isAcymailing":new MutationObserver(function(e){for(var t=0;t<e.length;t++)if("attributes"==e[t].type&&("none"==e[t].target.style.display||"0px"==e[t].target.style.height)){this.disconnect(),smetrics.showlog(e[t].target,"Acymailing form sended:",smetrics.uslog),smetrics.dataCollection(e[t].target);break}}).observe(e[t],{attributes:!0})}smetrics.showlog(e[t],"this elements:",smetrics.uslog)}})});